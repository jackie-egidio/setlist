<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="style.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <!-- <script src="api.js" type="text/javascript"></script> -->
        <meta charset="utf-8">
        <script>
            function fetchQuote() {
                // res = fetch("http://secretcheese.com/comp20/demo/location.json")
                //     .then (res => res.text())
                //     .then (data => console.log(data))
                //     .catch (error => console.log(error))	
                // } 

                res = fetch("https://favqs.com/api/qotd")
                    .then (res => res.text())
            }

            function getFavQ() {
                // make request
                request = new XMLHttpRequest();
                // console.log("1 - request object created");

                // open request file
                request.open("GET", "https://favqs.com/api/qotd", true);
                // console.log("2 - opened request file");

                // set up event handler/callback
                request.onreadystatechange = function() {
                    // console.log("3 - readystatechange event fired");

                    if (request.readyState == 4 && request.status == 200) {
                        // checks if successful
                        // console.log("5 - response received");
                        result = request.responseText;
                        alert(result);
                        favQ = JSON.parse(result);

                        document.getElementById("results").innerHTML = "Using request:" + "<br />" +
                            "Quote: " + favQ.quote.body + "<br />Author: " + favQ.quote.author;
                        fetchQuote();
                    }
                    else if (request.readyState == 4 && request.status != 200) {
                        document.getElementById("results").innerHTML = "Something is wrong";
                    }
                    else if (request.readyState == 3) {
                        document.getElementById("results").innerHTML = "Too soon.";
                    }
                }
                request.send();
                // console.log("4 - request sent");
            }
        </script>
    </head>
    <body onload="getFavQ();">
        <div id="info">
            <h1>My API: Twitter</h1>
            <h2>Found it on Postman.com or </h2>
            <h2 class="notBold">https://favqs.com/api/qotd</h2>
            <h3 class="notBold">Using this API, I get the quote of the day from FavQs.com. The results are below.</h3>
            <div id="results" style="font-size: 30px;">Oops! Something went wrong.</div>
        </div>
    </body>
</html>
